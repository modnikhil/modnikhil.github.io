<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Youtube Looper</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="http://bootswatch.com/yeti/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="miscCSS.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
        <script src="C:\Users\lab111\Documents\GitHub\modnikhil.github.io\auth.js"></script>
        <script src="C:\Users\lab111\Documents\GitHub\modnikhil.github.io\search.js"></script>
        <script src="https://apis.google.com/js/client.js?onload=googleApiClientReady"></script>
    </head>
    <body>
        <nav class="navbar navbar-inverse">
            <div class="container-fluid">
                <div class="navbar-header" >
                    <p class="navbar-brand noselect" >Youtube Looper</p>
                </div>
                <div class = "search-container">
                    <form class="navbar-form navbar-left" role="search">
                        <div class="form-group">
                            <input id="query" type="text" class="form-control" placeholder="Search Video" onkeydown="Javascript: if (event.keyCode==13) getResults();">
                        </div>
                        <input type = "button" class="btn btn-default" id="search" onclick="getResults();" value= "Search" >
                    </form>
                </div>
            </div>
        </nav>
        <div class="container">


            <!-- 1. The <iframe> (and video player) will replace this <div> tag. -->
            <div id="player"></div>

            <script>
                // 2. This code loads the IFrame Player API code asynchronously.
                
                var tag = document.createElement('script');

                tag.src = "https://www.youtube.com/iframe_api";
                var firstScriptTag = document.getElementsByTagName('script')[0];
                firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

                // 3. This function creates an <iframe> (and YouTube player)
                //    after the API code downloads.
                var player;
                function onYouTubeIframeAPIReady() {
                    player = new YT.Player('player', {
                        height: '390',
                        width: '640',
                        videoId: 'dVDk7PXNXB8',
                        //Next 4 lines dictate functions
                        events: {
                            //'onReady': onPlayerReady,
                            'onStateChange': onPlayerStateChange
                        }
                    });
                }

                // 4. The API will call this function when the video player is ready.
                function onPlayerReady(event) {
                    event.target.playVideo();
                }

                // 5. The API calls this function when the player's state changes.
                //    The function indicates that when playing a video (state=1),
                //    the player should play for six seconds and then stop.
                var done = false;
                function onPlayerStateChange(event) {
                    if (event.data == YT.PlayerState.ENDED) {
                        setTimeout(function() {
                            event.target.playVideo()
                        }, 2000);

                    }
                }
                function stopVideo() {
                    player.stopVideo();
                }
            </script>


            <div class="jumbotron">
                <h1>Youtube Looper</h1>
                <p>Resize this responsive page to see the effect!</p> 
            </div>

            <div class="row">
                <div class="col-sm-4">
                    <h3>Column 1</h3>
                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit...</p>
                    <p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris...</p>
                </div>
                <div class="col-sm-4">
                    <h3>Column 2</h3>
                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit...</p>
                    <p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris...</p>
                </div>
                <div class="col-sm-4">
                    <h3>Column 3</h3>        
                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit...</p>
                    <p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris...</p>
                </div>
            </div>
	<!-- <input type="button" value="test" onClick="addStatsFor(channels);"> -->

	<div id="results" style="margin-top:40px;"></div>


<script type="text/javascript">
	
function getResults(){
	var searchQry = document.getElementById('query').value;
	var xmlhttp = new XMLHttpRequest();
	var url = "https://www.googleapis.com/youtube/v3/search?part=snippet&q=" + searchQry + "&type=channel&maxResults=50&key=AIzaSyAMSSn3676V6m7-hX5nAI3Lff7sZKyJH0A";
	xmlhttp.onreadystatechange = function() {
	    if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
	        var myArr = JSON.parse(xmlhttp.responseText);
	        gatherChannels(myArr);
	        displayChannels(channels);
	    }
	}
	xmlhttp.open("GET", url, true);
	xmlhttp.send();
	function gatherChannels(arr) {
		// var i;
		for(i = 0; i < arr.items.length; i++) {
			var channel = {
				id : arr.items[i].id.channelId,
				gdata : "http://gdata.youtube.com/feeds/api/users/" + arr.items[i].id.channelId + "?alt=json",
				link : "https://www.youtube.com/channel/" + arr.items[i].id.channelId,
				title : arr.items[i].snippet.thumbnails.default.url,
				subscribers : 0
			}
			
			channels.push(channel);
		}
	}
	function displayChannels(arr) {
	    var out = "";
	    // var i;
	    for(i = 0; i < arr.length; i++) {
	        out += '<a target="_blank" style="text-decoration:none" href="' + arr[i].link + '"> <img src="' +
	        arr[i].title + '" heigh="150" width="150" style=padding:10px;></a>';
	    }
	    document.getElementById("results").innerHTML = out;
	}
}
var channels = channels || [];
</script>
        </div>

    </body>
</html>

